assert_lefthook_installed: true
colors: true

output:
  - success
  - failure
  - execution
  - execution_out

# commit-msg:
#   parallel: false
#   jobs:
#     - name: conform
#       run: go tool conform enforce --commit-msg-file {1}
#       skip:
#         - merge
#         - rebase

pre-commit:
  parallel: false
  jobs:
    - name: lefthook install
      group:
        parallel: false
        jobs:
          - name: install
            run: go tool lefthook install
            glob: "lefthook.yml"
    - name: validate repo
      group:
        parallel: false
        jobs:
          - name: tidy
            run: go mod tidy
            glob:
              - go.mod
              - go.sum
            stage_fixed: true
          - name: lint & format
            glob: "*.go"
            group:
              parallel: false
              jobs:
                - name: format
                  run: golangci-lint fmt ./...
                  stage_fixed: true
                - name: lint
                  run: golangci-lint run ./...

post-checkout:
  parallel: false
  jobs:
    - name: install
      run: go tool lefthook install
      files: if [ "{3}" = "1" ]; then git diff --name-only {1} {2}; fi
      glob: "lefthook.yml"
